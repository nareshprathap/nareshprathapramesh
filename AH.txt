







here's a Groovy script you can run in the Jenkins Script Console to:

     * Get your installed plugin list

     * Compare it against a target Jenkins core version

     * Identify if newer plugin versions exist that are compatible with that target core

     * Generate a version-pinned list (plugins.txt style)



Groovy Script: Suggest Latest Compatible Plugin Versions


import groovy.json.JsonSlurper

def targetJenkinsVersion = "2.440.1"
def updateCenterUrl = 'https://updates.jenkins.io/current/update-center.actual.json'

// Fetch update center data
def json = new URL(updateCenterUrl).text
def updateData = new JsonSlurper().parseText(json)

println "Target Jenkins Version: ${targetJenkinsVersion}"
println "---- Suggested plugin upgrades compatible with Jenkins ${targetJenkinsVersion} ----"

def pluginManager = Jenkins.instance.pluginManager
def compatiblePlugins = []

pluginManager.plugins.each { plugin ->
    def pluginId = plugin.shortName
    def installedVersion = plugin.version
    def availablePluginData = updateData.plugins[pluginId]

    if (availablePluginData) {
        def latestVersion = availablePluginData.version
        def requiredCore = availablePluginData.requiredCore ?: "1.0"

        if (new hudson.util.VersionNumber(requiredCore) <= new hudson.util.VersionNumber(targetJenkinsVersion)) {
            compatiblePlugins << "${pluginId}:${latestVersion}"
            println "${pluginId}:${latestVersion} (was ${installedVersion}, requires Jenkins ${requiredCore})"
        } else {
            println "[SKIPPED] ${pluginId}:${latestVersion} requires Jenkins ${requiredCore} > ${targetJenkinsVersion}"
        }
    } else {
        println "[WARNING] Plugin ${pluginId} not found in update center"
    }
}

println "\n--- Version-pinned plugins.txt output (copy below) ---"
compatiblePlugins.each { println it }



What It Does:

    * Reads your installed plugins

    * Fetches latest metadata from the Jenkins update center

    * Checks whether the latest version of each plugin is compatible with your target Jenkins version

    * Outputs a safe-to-use plugins.txt list

How to Use:

    * Go to Manage Jenkins > Script Console

    * Paste and run the script

    * Copy the final plugins.txt list

    * Use it with jenkins-plugin-cli in your Docker build or upgrade process














When you’re upgrading your Jenkins core version, choosing the correct plugin versions is critical to ensure compatibility, prevent failures, and avoid downtime.

Here’s a structured way to identify and upgrade to the correct plugin versions that match your target Jenkins core version:
Step-by-Step: Identifying Correct Plugin Versions for New Jenkins Core
1. Define Your Target Jenkins Core Version

Example: You're upgrading from 2.387.2 to 2.440.1.
2. Get a List of Currently Installed Plugins
Via Jenkins Script Console:

Jenkins.instance.pluginManager.plugins.each {
    println "${it.getShortName()}:${it.getVersion()} (requires Jenkins ${it.getRequiredCore()})"
}

Save this list — it’s your starting point.
3. Use the Jenkins Update Center to Get Compatible Versions

There are three effective ways to check compatibility:
Option A: Use jenkins-plugin-cli to Auto-Resolve Compatible Versions

If you have a plugins.txt file:

jenkins-plugin-cli --plugin-file plugins.txt --jenkins-version 2.440.1 --latest true

This downloads the latest plugin versions compatible with Jenkins 2.440.1, including dependencies.

You can also resolve versions without downloading:

jenkins-plugin-cli --plugin-file plugins.txt --jenkins-version 2.440.1 --available-updates

Option B: Use the Jenkins Plugin Site (Manual Check)

    Visit: https://plugins.jenkins.io

    Search for each plugin

    Scroll to "Version History"

    Pick the latest version that supports your target core version (e.g., 2.440.1)

Option C: Use Update Center JSON

Pull the actual update center data (contains core compatibility info):

curl https://updates.jenkins.io/current/update-center.actual.json

You can parse this to:

    Get all available plugin versions

    Check each version's requiredCore

    Useful for scripting automated validation.

4. Generate a Clean plugins.txt

After identifying compatible versions, generate a clean version-pinned file:

git:5.2.1
docker-workflow:572.v950f58993843
workflow-job:1347.vb_1d474d4b_40c

Pinning specific versions ensures stability and reproducibility during upgrades.
5. Test in a Staging Jenkins Instance

Before applying to production:

    Build a Jenkins Docker container with your new plugins.txt

    Run Jenkins with the new core

    Import jobs and test builds

This minimizes surprises during the actual upgrade.
Bonus: Groovy Script to Flag Incompatible Plugins

def targetVersion = new hudson.util.VersionNumber("2.440.1")

Jenkins.instance.pluginManager.plugins.each {
    if (it.getRequiredCore().isNewerThan(targetVersion)) {
        println "[WARN] ${it.getShortName()}:${it.getVersion()} requires Jenkins ${it.getRequiredCore()} (target: ${targetVersion})"
    }
}

TL;DR (Quick Checklist):
Step	Task
1	Identify your target Jenkins core version
2	Export list of currently installed plugins
3	Use jenkins-plugin-cli or plugin site to find compatible versions
4	Create a version-pinned plugins.txt
5	Test everything in a staging Jenkins
6	Upgrade Jenkins core in production







if you're planning to upgrade your Jenkins core version and already have a set of installed plugins, it’s crucial to verify compatibility to avoid breaking your jobs or pipelines.

Here’s a step-by-step guide to verify that your new Jenkins core version is compatible with your currently installed plugins.
Step 1: Get Your Current Plugin List with Required Core
Option A: Use Jenkins Script Console

Run this Groovy script:

Jenkins.instance.pluginManager.plugins.each {
    println "${it.getShortName()}:${it.getVersion()} (requires Jenkins ${it.getRequiredCore()})"
}

It prints:

git:5.2.1 (requires Jenkins 2.375.1)
workflow-aggregator:596.v8c21c963d92d (requires Jenkins 2.361.1)

    Save this list — you’ll use it to compare with your target Jenkins core version.

Step 2: Decide the Target Jenkins Version

Example: you're planning to upgrade from 2.387.2 to 2.440.1.
Step 3: Check Compatibility for Each Plugin

Use one of these methods:
Option A: Groovy Script to Highlight Incompatible Plugins

Run this in script console before upgrading Jenkins:

def targetCore = new hudson.util.VersionNumber("2.440.1")

Jenkins.instance.pluginManager.plugins.each {
    def requiredCore = it.getRequiredCore()
    if (requiredCore && requiredCore.isNewerThan(targetCore)) {
        println "[INCOMPATIBLE] ${it.getShortName()}:${it.getVersion()} requires Jenkins ${requiredCore}"
    }
}

    This will warn you if any plugin requires a Jenkins core higher than your upgrade target, or if plugin will break after upgrading.

Option B: Use jenkins-plugin-cli for Pre-Validation (Recommended for Docker)

If you're using plugins.txt or managing plugins declaratively:

jenkins-plugin-cli --plugin-file plugins.txt --jenkins-version 2.440.1

This:

    Verifies that each plugin in plugins.txt supports Jenkins 2.440.1

    Will error if any plugin is incompatible

Option C: Manually Check via Plugin Site

    Go to https://plugins.jenkins.io

    Search for each plugin

    Check the required Jenkins core for your installed version

Step 4: Update Plugins if Needed

If some plugins are incompatible:

    Upgrade them first while still on the old Jenkins version

    Then upgrade Jenkins core

    Some plugin upgrades include migration steps that work better before core upgrade.

Step 5: Backup and Test Before Upgrade

Before upgrading:

    Backup $JENKINS_HOME (configs, jobs, credentials, plugins)

    Test the upgrade in a staging environment with the same plugin/core versions

    Confirm builds, jobs, pipelines, credentials work as expected

Summary Flow:

[Export plugin list] → [Pick target Jenkins core version]
          ↓
[Compare requiredCore of plugins vs target version]
          ↓
[Upgrade plugins if needed] → [Test in staging]
          ↓
        [Upgrade Jenkins core in prod]